<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>KDE Plasma X11 login hang - Hank's public Docs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Hank's public Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Hank's Docs home page</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Food</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../food/bean-dip/" class="dropdown-item">Bean Dip</a>
</li>
                                    
<li>
    <a href="../../food/peach-cobbler/" class="dropdown-item">Peach Cobbler from scratch</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Tech</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../tech/Debian_ZFS_on_root_to_a_new_drive/" class="dropdown-item">Debian Root on ZFS to a new drive</a>
</li>
                                    
<li>
    <a href="../../tech/ESP8266-RTOS-SDK_on_Debian/" class="dropdown-item">Using ESP8266-RTOS-SDK on Debian</a>
</li>
                                    
<li>
    <a href="../../tech/NVME_performance-Bicool_Mini_Base-vs-IO_Board/" class="dropdown-item">Pi CM4 NVME performance: Bicool Mini Base vs. IO Board</a>
</li>
                                    
<li>
    <a href="../../tech/OWI-535-Robot_Arm_Control_assembly/" class="dropdown-item">OWI-535 Robot Arm Control assembly</a>
</li>
                                    
<li>
    <a href="../../tech/Pi-Debian-Root-on-ZFS/" class="dropdown-item">Raspberry Pi installed with root on ZFS</a>
</li>
                                    
<li>
    <a href="../../tech/Pi-Zero_Debian_DS18B20/" class="dropdown-item">Pi Zero/W with working DS18B20</a>
</li>
                                    
<li>
    <a href="../../tech/Raspberry-Pi/" class="dropdown-item">Raspberry Pi</a>
</li>
                                    
<li>
    <a href="../../tech/TUI-challenge/" class="dropdown-item">Jupiter Broadcasting TUI challenge</a>
</li>
                                    
<li>
    <a href="../../tech/Troubleshooting-Debian-root-on-ZFS/" class="dropdown-item">Troubleshooting Debian root on ZFS</a>
</li>
                                    
<li>
    <a href="../../tech/ZBM-Void-Linux/" class="dropdown-item">Void Linux, MBR boot using ZFSBootMenu</a>
</li>
                                    
<li>
    <a href="../../tech/ZFS-boot-menu/" class="dropdown-item">ZFS boot menu</a>
</li>
                                    
<li>
    <a href="../../tech/dphacks-CM4_Ether_Board/" class="dropdown-item">dphacks CM4 Ether Board</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Data</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../tech/data/benchmarks/" class="dropdown-item">CM4 benchmarks</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Test debug</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Pi-4B-Bookworm-WiFi/" class="dropdown-item">Testing networking (WiFi, ETH) Pi 4B</a>
</li>
                                    
<li>
    <a href="../Pi-4B-Bookworm-testing/" class="dropdown-item">Pi 4B Bookworm testing</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">KDE Plasma X11 login hang</a>
</li>
                                    
<li>
    <a href="../Pi-4B-firmware/" class="dropdown-item">Firmware issue raspi-firmware Debian Bookworm</a>
</li>
                                    
<li>
    <a href="../Pi-new-CM4-WiFi-debugging/" class="dropdown-item">New Raspberry Pi CM4 WiFi testing</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Pi CM4 PCIe</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../Pi-CM4-PCIe/Pi_CM4_PCIe_testing/" class="dropdown-item">Pi CM4 PCIe testing</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Sanoid</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../Sanoid/sanoid/" class="dropdown-item">Sanoid issue #813 testing</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Pi-4B-Bookworm-testing/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Pi-4B-firmware/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-light">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#kde-plasma-x11-login-hang" class="nav-link">KDE Plasma X11 login hang</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#2023-03-25-previous" class="nav-link">2023-03-25 Previous</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#2023-03-25-process" class="nav-link">2023-03-25 Process</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conclusion-2023-03-25" class="nav-link">~~Conclusion~~ 2023-03-25</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#2023-03-26-filing-a-bug-report" class="nav-link">2023-03-26 Filing a bug report</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#2023-03-26-try-xfce" class="nav-link">2023-03-26 try XFCE</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#2023-04-29-further-patches-to-test" class="nav-link">2023-04-29 further patches to test.</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="kde-plasma-x11-login-hang">KDE Plasma X11 login hang</h1>
<p>Host: Debian Bookworm on Raspberry Pi 4B (USB/SSD boot)</p>
<p>Reported at <a href="https://bugs.kde.org/show_bug.cgi?id=467812">https://bugs.kde.org/show_bug.cgi?id=467812</a></p>
<p>Testing the KDE Plasma desktop on Debian Bookworm on a Pi 4B running the 64 bit Debian (not Raspberry Pi) OS. Bookworm is a pending Debian release which at present (2023-03-25) is in "hard freeze" and it is important to get all functionality working.</p>
<h2 id="2023-03-25-previous">2023-03-25 Previous</h2>
<p>During testing to confirm that the bug <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1019700">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1019700</a> had been fixed, it was noted that the desktop hung when logging in. In order to test the bug, the system was upgraded to Debian Unstable. When the system was on Debian Testing, the same issue occurred. Since Testing is in hard freeze (and to be released as Bookworm) the hang warranted further investigation  and on Bookworm. This Pi 4B is ordinarily run on a different SSD with Bullseye installed and has not had this problem.</p>
<h2 id="2023-03-25-process">2023-03-25 Process</h2>
<ol>
<li>Image the SSD with  downloaded from <a href="https://raspi.debian.net/tested-images/">https://raspi.debian.net/tested-images/</a>.</li>
<li>Boot and allow to resize and reboot and login. (Rebooting as necessary to get a session that did not exhibit the emmc timeout issue.)</li>
<li>Housekeeping: hostname (<code>charm</code>), time zone, install <code>sudo</code> and <code>vim</code> and add user <code>hbarta</code>.</li>
<li><code>apt update</code>, <code>apt upgrade</code></li>
<li>Install a kernel (from Unstable) <code>linux-image-6.1.0-7-arm64_6.1.20-1_arm64.deb</code> downloaded from <a href="https://packages.debian.org/sid/linux-image-6.1.0-7-arm64">https://packages.debian.org/sid/linux-image-6.1.0-7-arm64</a>. No additional dependencies were required.</li>
<li>Reboot.</li>
<li>Install a minimal KDE Plasma desktop (<code>apt install plasma-desktop</code>)</li>
<li>Reboot. No DM. No <code>xinit</code>. No <code>startx</code>. Went ahead and installed <code>sddm</code>.</li>
<li>Start <code>sddm</code> which brings up DM.</li>
<li>Login in. Works as expected. Logout.</li>
<li>Login using Wayland. Works as expected.</li>
</ol>
<p>After concluding that everything was good, I continued testing and found myself unable to log in again. Additional operations included:</p>
<ol>
<li>Install Chromium and Konsole.</li>
<li>Overclocking to 2MHz</li>
<li>Back out of the overclock.</li>
<li>Can't login.</li>
<li>Add another user <code>arnold</code> and try to login as the new user. Still hangs.</li>
</ol>
<h2 id="conclusion-2023-03-25">~~Conclusion~~ 2023-03-25</h2>
<p>Seems like a non-problem. Will continue to test. ... Sadly after some usage, login once again hangs. Will repeat the test.</p>
<ol>
<li>Image the SSD with  downloaded from <a href="https://raspi.debian.net/tested-images/">https://raspi.debian.net/tested-images/</a>.</li>
<li>Boot and allow to resize and reboot and login. (Rebooting as necessary to get a session that did not exhibit the emmc timeout issue.)</li>
<li>Housekeeping: hostname (<code>charm</code>), time zone and add user <code>hbarta</code>.</li>
<li><code>apt update</code>, <code>apt upgrade</code></li>
<li>Install a kernel (from Unstable) <code>linux-image-6.1.0-7-arm64_6.1.20-1_arm64.deb</code> downloaded from <a href="https://packages.debian.org/sid/linux-image-6.1.0-7-arm64">https://packages.debian.org/sid/linux-image-6.1.0-7-arm64</a>. No additional dependencies were required.</li>
<li><code>apt install plasma-desktop sddm konsole chromium vim -y</code></li>
<li>Reboot.</li>
<li>Login (defaults to Wayland) and looks OK.</li>
<li>Logout and start monitors <code>dmesg -follow</code>, <code>cd /var/log;tail -f Xorg.0.log</code></li>
<li>Login (Wayland) and all looks good.</li>
<li>Logout</li>
<li>Login (Wayland) and all looks good.</li>
<li>Start and exit Konsole</li>
<li>Start and exit Chromium</li>
<li>logout and login</li>
<li>Open Chromium. and open google.com. OK. Try to open second page and browser is foobar. Doesn't echo typing, finally able to open a second page (local MkDocs notes) and display is incomplete.</li>
<li>Open system monitor and Konsole and they work OK. Close all and logout.</li>
<li>Login to X.org session. Login hangs.</li>
<li><code>systemctl restart sddm</code></li>
<li>Login to X.org session. Login hangs.</li>
<li><code>systemctl restart sddm</code></li>
<li>Login to Wayland session. Login OK.</li>
</ol>
<h2 id="2023-03-26-filing-a-bug-report">2023-03-26 Filing a bug report</h2>
<ol>
<li>Collect information</li>
<li>Prepare pastebin content</li>
</ol>
<h2 id="2023-03-26-try-xfce">2023-03-26 try XFCE</h2>
<p>Test two things:</p>
<ol>
<li>X11 works with another DE</li>
<li>XFCE installs <code>lightdm</code>, can test that with KDE</li>
</ol>
<p>Result: </p>
<ul>
<li>XFCE (on X11) starts w/out issue using <code>lightdm</code> or <code>sddm</code>. </li>
<li>Plasma/X11 hangs when started using <code>lightdm</code>.</li>
<li>Plasma/Wayland starts normally from <code>lightdm</code>.</li>
</ul>
<p>Bug report at <a href="https://bugs.kde.org/show_bug.cgi?id=467812">https://bugs.kde.org/show_bug.cgi?id=467812</a></p>
<h2 id="2023-04-29-further-patches-to-test">2023-04-29 further patches to test.</h2>
<p>Ref: <a href="https://lore.kernel.org/all/20230428223500.23337-5-jim2101024@gmail.com/">https://lore.kernel.org/all/20230428223500.23337-5-jim2101024@gmail.com/</a> and <a href="https://lore.kernel.org/all/20230428223500.23337-1-jim2101024@gmail.com/">https://lore.kernel.org/all/20230428223500.23337-1-jim2101024@gmail.com/</a><br />
Suggested by kibi </p>
<blockquote>
<p>fetch the patch series from the LKML, and apply it either on the base commit mentioned there, or to current mainline master<br />
(b4 is super useful, <code>b4 mbox $message_id</code> and you got an mbox ready to <code>git am</code>)</p>
</blockquote></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
